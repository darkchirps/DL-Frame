"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.imagesToBinarySimple = imagesToBinarySimple;
// image-to-binary-simple.ts
const fs = require("fs");
const path = require("path");
const picBinPath = require("../config.json").picBinPath;
// 支持的图片格式
const SUPPORTED_FORMATS = ['.png', '.jpg', '.jpeg', '.gif', '.webp', '.bmp', '.tiff'];
function imagesToBinarySimple(inputDir) {
    // 确保输出目录存在
    if (!fs.existsSync(picBinPath)) {
        fs.mkdirSync(picBinPath, { recursive: true });
    }
    // 获取所有文件
    const files = fs.readdirSync(inputDir);
    const generatedFiles = [];
    // 处理每个文件
    files.forEach(file => {
        const filePath = path.join(inputDir, file);
        const ext = path.extname(file).toLowerCase();
        // 检查是否为图片文件
        if (!SUPPORTED_FORMATS.includes(ext)) {
            console.warn(`跳过非图片文件: ${file}`);
            return;
        }
        // 检查文件是否存在
        if (!fs.existsSync(filePath)) {
            console.warn(`文件不存在: ${file}`);
            return;
        }
        try {
            // 读取图片文件
            const imageData = fs.readFileSync(filePath);
            // 生成输出文件名（保持原名，只改扩展名）
            const fileNameWithoutExt = path.basename(file, ext);
            const binaryFileName = `${fileNameWithoutExt}.bin`;
            const binaryOutputFile = path.join(picBinPath, binaryFileName);
            // 写入二进制文件
            fs.writeFileSync(binaryOutputFile, imageData);
            generatedFiles.push(binaryOutputFile);
            console.log(`转换成功: ${file} -> ${binaryFileName}`);
        }
        catch (error) {
            console.error(`处理图片 ${file} 时出错:`, error);
        }
    });
    return generatedFiles;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGljVG9CaW4uanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zb3VyY2UvcGljVG9CaW4udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFTQSxvREFnREM7QUF6REQsNEJBQTRCO0FBQzVCLE1BQU0sRUFBRSxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUN6QixNQUFNLElBQUksR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUM7QUFFN0IsTUFBTSxVQUFVLEdBQUcsT0FBTyxDQUFDLGdCQUFnQixDQUFDLENBQUMsVUFBVSxDQUFDO0FBRXhELFVBQVU7QUFDVixNQUFNLGlCQUFpQixHQUFHLENBQUMsTUFBTSxFQUFFLE1BQU0sRUFBRSxPQUFPLEVBQUUsTUFBTSxFQUFFLE9BQU8sRUFBRSxNQUFNLEVBQUUsT0FBTyxDQUFDLENBQUM7QUFFdEYsU0FBZ0Isb0JBQW9CLENBQUMsUUFBZ0I7SUFDakQsV0FBVztJQUNYLElBQUksQ0FBQyxFQUFFLENBQUMsVUFBVSxDQUFDLFVBQVUsQ0FBQyxFQUFFLENBQUM7UUFDN0IsRUFBRSxDQUFDLFNBQVMsQ0FBQyxVQUFVLEVBQUUsRUFBRSxTQUFTLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQztJQUNsRCxDQUFDO0lBRUQsU0FBUztJQUNULE1BQU0sS0FBSyxHQUFhLEVBQUUsQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLENBQUM7SUFDakQsTUFBTSxjQUFjLEdBQWEsRUFBRSxDQUFDO0lBRXBDLFNBQVM7SUFDVCxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxFQUFFO1FBQ2pCLE1BQU0sUUFBUSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQzNDLE1BQU0sR0FBRyxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7UUFFN0MsWUFBWTtRQUNaLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQztZQUNuQyxPQUFPLENBQUMsSUFBSSxDQUFDLFlBQVksSUFBSSxFQUFFLENBQUMsQ0FBQztZQUNqQyxPQUFPO1FBQ1gsQ0FBQztRQUVELFdBQVc7UUFDWCxJQUFJLENBQUMsRUFBRSxDQUFDLFVBQVUsQ0FBQyxRQUFRLENBQUMsRUFBRSxDQUFDO1lBQzNCLE9BQU8sQ0FBQyxJQUFJLENBQUMsVUFBVSxJQUFJLEVBQUUsQ0FBQyxDQUFDO1lBQy9CLE9BQU87UUFDWCxDQUFDO1FBRUQsSUFBSSxDQUFDO1lBQ0QsU0FBUztZQUNULE1BQU0sU0FBUyxHQUFHLEVBQUUsQ0FBQyxZQUFZLENBQUMsUUFBUSxDQUFDLENBQUM7WUFFNUMsc0JBQXNCO1lBQ3RCLE1BQU0sa0JBQWtCLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLEVBQUUsR0FBRyxDQUFDLENBQUM7WUFDcEQsTUFBTSxjQUFjLEdBQUcsR0FBRyxrQkFBa0IsTUFBTSxDQUFDO1lBQ25ELE1BQU0sZ0JBQWdCLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxVQUFVLEVBQUUsY0FBYyxDQUFDLENBQUM7WUFFL0QsVUFBVTtZQUNWLEVBQUUsQ0FBQyxhQUFhLENBQUMsZ0JBQWdCLEVBQUUsU0FBUyxDQUFDLENBQUM7WUFFOUMsY0FBYyxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1lBQ3RDLE9BQU8sQ0FBQyxHQUFHLENBQUMsU0FBUyxJQUFJLE9BQU8sY0FBYyxFQUFFLENBQUMsQ0FBQztRQUV0RCxDQUFDO1FBQUMsT0FBTyxLQUFLLEVBQUUsQ0FBQztZQUNiLE9BQU8sQ0FBQyxLQUFLLENBQUMsUUFBUSxJQUFJLE9BQU8sRUFBRSxLQUFLLENBQUMsQ0FBQztRQUM5QyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxPQUFPLGNBQWMsQ0FBQztBQUMxQixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLy8gaW1hZ2UtdG8tYmluYXJ5LXNpbXBsZS50c1xyXG5jb25zdCBmcyA9IHJlcXVpcmUoXCJmc1wiKTtcclxuY29uc3QgcGF0aCA9IHJlcXVpcmUoXCJwYXRoXCIpO1xyXG5cclxuY29uc3QgcGljQmluUGF0aCA9IHJlcXVpcmUoXCIuLi9jb25maWcuanNvblwiKS5waWNCaW5QYXRoO1xyXG5cclxuLy8g5pSv5oyB55qE5Zu+54mH5qC85byPXHJcbmNvbnN0IFNVUFBPUlRFRF9GT1JNQVRTID0gWycucG5nJywgJy5qcGcnLCAnLmpwZWcnLCAnLmdpZicsICcud2VicCcsICcuYm1wJywgJy50aWZmJ107XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaW1hZ2VzVG9CaW5hcnlTaW1wbGUoaW5wdXREaXI6IHN0cmluZyk6IHN0cmluZ1tdIHtcclxuICAgIC8vIOehruS/nei+k+WHuuebruW9leWtmOWcqFxyXG4gICAgaWYgKCFmcy5leGlzdHNTeW5jKHBpY0JpblBhdGgpKSB7XHJcbiAgICAgICAgZnMubWtkaXJTeW5jKHBpY0JpblBhdGgsIHsgcmVjdXJzaXZlOiB0cnVlIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOiOt+WPluaJgOacieaWh+S7tlxyXG4gICAgY29uc3QgZmlsZXM6IHN0cmluZ1tdID0gZnMucmVhZGRpclN5bmMoaW5wdXREaXIpO1xyXG4gICAgY29uc3QgZ2VuZXJhdGVkRmlsZXM6IHN0cmluZ1tdID0gW107XHJcblxyXG4gICAgLy8g5aSE55CG5q+P5Liq5paH5Lu2XHJcbiAgICBmaWxlcy5mb3JFYWNoKGZpbGUgPT4ge1xyXG4gICAgICAgIGNvbnN0IGZpbGVQYXRoID0gcGF0aC5qb2luKGlucHV0RGlyLCBmaWxlKTtcclxuICAgICAgICBjb25zdCBleHQgPSBwYXRoLmV4dG5hbWUoZmlsZSkudG9Mb3dlckNhc2UoKTtcclxuXHJcbiAgICAgICAgLy8g5qOA5p+l5piv5ZCm5Li65Zu+54mH5paH5Lu2XHJcbiAgICAgICAgaWYgKCFTVVBQT1JURURfRk9STUFUUy5pbmNsdWRlcyhleHQpKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUud2Fybihg6Lez6L+H6Z2e5Zu+54mH5paH5Lu2OiAke2ZpbGV9YCk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIOajgOafpeaWh+S7tuaYr+WQpuWtmOWcqFxyXG4gICAgICAgIGlmICghZnMuZXhpc3RzU3luYyhmaWxlUGF0aCkpIHtcclxuICAgICAgICAgICAgY29uc29sZS53YXJuKGDmlofku7bkuI3lrZjlnKg6ICR7ZmlsZX1gKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgLy8g6K+75Y+W5Zu+54mH5paH5Lu2XHJcbiAgICAgICAgICAgIGNvbnN0IGltYWdlRGF0YSA9IGZzLnJlYWRGaWxlU3luYyhmaWxlUGF0aCk7XHJcblxyXG4gICAgICAgICAgICAvLyDnlJ/miJDovpPlh7rmlofku7blkI3vvIjkv53mjIHljp/lkI3vvIzlj6rmlLnmianlsZXlkI3vvIlcclxuICAgICAgICAgICAgY29uc3QgZmlsZU5hbWVXaXRob3V0RXh0ID0gcGF0aC5iYXNlbmFtZShmaWxlLCBleHQpO1xyXG4gICAgICAgICAgICBjb25zdCBiaW5hcnlGaWxlTmFtZSA9IGAke2ZpbGVOYW1lV2l0aG91dEV4dH0uYmluYDtcclxuICAgICAgICAgICAgY29uc3QgYmluYXJ5T3V0cHV0RmlsZSA9IHBhdGguam9pbihwaWNCaW5QYXRoLCBiaW5hcnlGaWxlTmFtZSk7XHJcblxyXG4gICAgICAgICAgICAvLyDlhpnlhaXkuozov5vliLbmlofku7ZcclxuICAgICAgICAgICAgZnMud3JpdGVGaWxlU3luYyhiaW5hcnlPdXRwdXRGaWxlLCBpbWFnZURhdGEpO1xyXG5cclxuICAgICAgICAgICAgZ2VuZXJhdGVkRmlsZXMucHVzaChiaW5hcnlPdXRwdXRGaWxlKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coYOi9rOaNouaIkOWKnzogJHtmaWxlfSAtPiAke2JpbmFyeUZpbGVOYW1lfWApO1xyXG5cclxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGDlpITnkIblm77niYcgJHtmaWxlfSDml7blh7rplJk6YCwgZXJyb3IpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBnZW5lcmF0ZWRGaWxlcztcclxufSJdfQ==