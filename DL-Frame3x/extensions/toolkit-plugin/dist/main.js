"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.methods = void 0;
exports.load = load;
exports.unload = unload;
// @ts-ignore
const { dialog } = require('electron');
const fs = require("fs");
const path = require('path');
/**
 * @en Registration method for the main process of Extension
 * @zh 为扩展的主进程的注册方法
 */
exports.methods = {
    /**
     * @en A method that can be triggered by message
     * @zh 通过 message 触发的方法
     */
    open_jsonChange() {
        dialog.showOpenDialog({
            properties: ['openDirectory']
        }).then((result) => {
            if (!result.canceled && result.filePaths.length > 0) {
                const pathTo = result.filePaths[0];
                const toJson = require("./xlsxToJson");
                console.log('开始表格转json');
                // 设置输出目录
                const outputDir = path.join(Editor.Project.path, 'assets/resources/json');
                // 执行转换
                toJson.xlsxToJson(pathTo, outputDir);
                //转换成功，通知引擎刷新资源
                const floats = fs.readdirSync(outputDir);
                floats.forEach((float) => {
                    if (float.endsWith('.meta')) {
                        const fullPath = path.join(`${outputDir}`, `${float}`);
                        const fileContent = fs.readFileSync(fullPath, 'utf8');
                        // @ts-ignore
                        Editor.Message.request('asset-db', 'refresh-asset', fileContent["uuid"]);
                    }
                });
                console.log('---------------------------表格转json完成---------------------------');
            }
        }).catch((err) => {
            console.log('表格转json选择文件夹失败');
        });
    },
    open_binChange() {
        dialog.showOpenDialog({
            properties: ['openDirectory']
        }).then((result) => {
            if (!result.canceled && result.filePaths.length > 0) {
                const pathTo = result.filePaths[0];
                const toBin = require("./xlsxToBin");
                console.log('开始表格转bin');
                // 设置输出目录
                const outputDir = path.join(Editor.Project.path, 'assets/resources/bin');
                // 执行转换
                toBin.xlsxToBinary(pathTo, outputDir);
                //转换成功，通知引擎刷新资源
                const floats = fs.readdirSync(outputDir);
                floats.forEach((float) => {
                    if (float.endsWith('.meta')) {
                        const fullPath = path.join(outputDir, `${float}`);
                        const fileContent = fs.readFileSync(fullPath, 'utf8');
                        // @ts-ignore
                        Editor.Message.request('asset-db', 'refresh-asset', fileContent["uuid"]);
                    }
                });
                console.log('---------------------------表格转bin完成---------------------------');
            }
        }).catch((err) => {
            console.log('表格转bin选择文件夹失败');
        });
    },
    open_pic_txtChange() {
        dialog.showOpenDialog({
            properties: ['openDirectory']
        }).then((result) => {
            if (!result.canceled && result.filePaths.length > 0) {
                const pathTo = result.filePaths[0];
                const convert = require("./picToTxt");
                console.log('开始图片转txt');
                convert.changeTxtFunc(pathTo);
                console.log('---------------------------图片转txt完成---------------------------');
            }
        }).catch((err) => {
            console.log('图片转txt选择文件夹失败');
        });
    },
    open_pic_binChange() {
        dialog.showOpenDialog({
            properties: ['openDirectory']
        }).then((result) => {
            if (!result.canceled && result.filePaths.length > 0) {
                const pathTo = result.filePaths[0];
                const convert = require("./picToBin");
                console.log('开始图片转bin');
                convert.imagesToBinarySimple(pathTo);
                console.log('---------------------------图片转bin完成---------------------------');
            }
        }).catch((err) => {
            console.log('图片转bin选择文件夹失败');
        });
    },
    open_videoFrame() {
        dialog.showOpenDialog({
            properties: ['openDirectory']
        }).then((result) => {
            if (!result.canceled && result.filePaths.length > 0) {
                const pathTo = result.filePaths[0];
                const video = require("./videoFrame");
                console.log('开始提取视频首帧');
                video.videoToFrame(pathTo);
            }
        }).catch((err) => {
            console.log('视频首帧选择文件夹失败');
        });
    }
};
/**
 * @en Method Triggered on Extension Startup
 * @zh 扩展启动时触发的方法
 */
function load() { }
/**
 * @en Method triggered when uninstalling the extension
 * @zh 卸载扩展时触发的方法
 */
function unload() { }
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NvdXJjZS9tYWluLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQXVIQSxvQkFBMEI7QUFNMUIsd0JBQTRCO0FBN0g1QixhQUFhO0FBQ2IsTUFBTSxFQUFFLE1BQU0sRUFBRSxHQUFHLE9BQU8sQ0FBQyxVQUFVLENBQUMsQ0FBQztBQUN2QyxNQUFNLEVBQUUsR0FBRyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDekIsTUFBTSxJQUFJLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDO0FBQzdCOzs7R0FHRztBQUNVLFFBQUEsT0FBTyxHQUE0QztJQUM1RDs7O09BR0c7SUFDSCxlQUFlO1FBQ1gsTUFBTSxDQUFDLGNBQWMsQ0FBQztZQUNsQixVQUFVLEVBQUUsQ0FBQyxlQUFlLENBQUM7U0FDaEMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLE1BQVksRUFBRSxFQUFFO1lBQ3JCLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxJQUFJLE1BQU0sQ0FBQyxTQUFTLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRSxDQUFDO2dCQUNsRCxNQUFNLE1BQU0sR0FBRyxNQUFNLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDO2dCQUNuQyxNQUFNLE1BQU0sR0FBRyxPQUFPLENBQUMsY0FBYyxDQUFDLENBQUM7Z0JBQ3ZDLE9BQU8sQ0FBQyxHQUFHLENBQUMsV0FBVyxDQUFDLENBQUM7Z0JBQ3pCLFNBQVM7Z0JBQ1QsTUFBTSxTQUFTLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLElBQUksRUFBRSx1QkFBdUIsQ0FBQyxDQUFDO2dCQUMxRSxPQUFPO2dCQUNQLE1BQU0sQ0FBQyxVQUFVLENBQUMsTUFBTSxFQUFFLFNBQVMsQ0FBQyxDQUFDO2dCQUNyQyxlQUFlO2dCQUNmLE1BQU0sTUFBTSxHQUFHLEVBQUUsQ0FBQyxXQUFXLENBQUMsU0FBUyxDQUFD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QUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxHQUFTLEVBQUUsRUFBRTtZQUNuQixPQUFPLENBQUMsR0FBRyxDQUFDLGVBQWUsQ0FBQyxDQUFDO1FBQ2pDLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQUNELGVBQWU7UUFDWCxNQUFNLENBQUMsY0FBYyxDQUFDO1lBQ2xCLFVBQVUsRUFBRSxDQUFDLGVBQWUsQ0FBQztTQUNoQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsTUFBWSxFQUFFLEVBQUU7WUFDckIsSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLElBQUksTUFBTSxDQUFDLFNBQVMsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFLENBQUM7Z0JBQ2xELE1BQU0sTUFBTSxHQUFHLE1BQU0sQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUM7Z0JBQ25DLE1BQU0sS0FBSyxHQUFHLE9BQU8sQ0FBQyxjQUFjLENBQUMsQ0FBQztnQkFDdEMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsQ0FBQztnQkFDeEIsS0FBSyxDQUFDLFlBQVksQ0FBQyxNQUFNLENBQUMsQ0FBQTtZQUM5QixDQUFDO1FBQ0wsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsR0FBUyxFQUFFLEVBQUU7WUFDbkIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxhQUFhLENBQUMsQ0FBQztRQUMvQixDQUFDLENBQUMsQ0FBQztJQUNQLENBQUM7Q0FDSixDQUFDO0FBRUY7OztHQUdHO0FBQ0gsU0FBZ0IsSUFBSSxLQUFLLENBQUM7QUFFMUI7OztHQUdHO0FBQ0gsU0FBZ0IsTUFBTSxLQUFLLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBAdHMtaWdub3JlXHJcbmNvbnN0IHsgZGlhbG9nIH0gPSByZXF1aXJlKCdlbGVjdHJvbicpO1xyXG5jb25zdCBmcyA9IHJlcXVpcmUoXCJmc1wiKTtcclxuY29uc3QgcGF0aCA9IHJlcXVpcmUoJ3BhdGgnKTtcclxuLyoqXHJcbiAqIEBlbiBSZWdpc3RyYXRpb24gbWV0aG9kIGZvciB0aGUgbWFpbiBwcm9jZXNzIG9mIEV4dGVuc2lvblxyXG4gKiBAemgg5Li65omp5bGV55qE5Li76L+b56iL55qE5rOo5YaM5pa55rOVXHJcbiAqL1xyXG5leHBvcnQgY29uc3QgbWV0aG9kczogeyBba2V5OiBzdHJpbmddOiAoLi4uYW55OiBhbnkpID0+IGFueSB9ID0ge1xyXG4gICAgLyoqXHJcbiAgICAgKiBAZW4gQSBtZXRob2QgdGhhdCBjYW4gYmUgdHJpZ2dlcmVkIGJ5IG1lc3NhZ2VcclxuICAgICAqIEB6aCDpgJrov4cgbWVzc2FnZSDop6blj5HnmoTmlrnms5VcclxuICAgICAqL1xyXG4gICAgb3Blbl9qc29uQ2hhbmdlKCkge1xyXG4gICAgICAgIGRpYWxvZy5zaG93T3BlbkRpYWxvZyh7XHJcbiAgICAgICAgICAgIHByb3BlcnRpZXM6IFsnb3BlbkRpcmVjdG9yeSddXHJcbiAgICAgICAgfSkudGhlbigocmVzdWx0PzogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmICghcmVzdWx0LmNhbmNlbGVkICYmIHJlc3VsdC5maWxlUGF0aHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcGF0aFRvID0gcmVzdWx0LmZpbGVQYXRoc1swXTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHRvSnNvbiA9IHJlcXVpcmUoXCIuL3hsc3hUb0pzb25cIik7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygn5byA5aeL6KGo5qC86L2sanNvbicpO1xyXG4gICAgICAgICAgICAgICAgLy8g6K6+572u6L6T5Ye655uu5b2VXHJcbiAgICAgICAgICAgICAgICBjb25zdCBvdXRwdXREaXIgPSBwYXRoLmpvaW4oRWRpdG9yLlByb2plY3QucGF0aCwgJ2Fzc2V0cy9yZXNvdXJjZXMvanNvbicpO1xyXG4gICAgICAgICAgICAgICAgLy8g5omn6KGM6L2s5o2iXHJcbiAgICAgICAgICAgICAgICB0b0pzb24ueGxzeFRvSnNvbihwYXRoVG8sIG91dHB1dERpcik7XHJcbiAgICAgICAgICAgICAgICAvL+i9rOaNouaIkOWKn++8jOmAmuefpeW8leaTjuWIt+aWsOi1hOa6kFxyXG4gICAgICAgICAgICAgICAgY29uc3QgZmxvYXRzID0gZnMucmVhZGRpclN5bmMob3V0cHV0RGlyKTtcclxuICAgICAgICAgICAgICAgIGZsb2F0cy5mb3JFYWNoKChmbG9hdDogc3RyaW5nKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZsb2F0LmVuZHNXaXRoKCcubWV0YScpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZ1bGxQYXRoID0gcGF0aC5qb2luKGAke291dHB1dERpcn1gLCBgJHtmbG9hdH1gKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZUNvbnRlbnQgPSBmcy5yZWFkRmlsZVN5bmMoZnVsbFBhdGgsICd1dGY4Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgRWRpdG9yLk1lc3NhZ2UucmVxdWVzdCgnYXNzZXQtZGInLCAncmVmcmVzaC1hc3NldCcsIGZpbGVDb250ZW50W1widXVpZFwiXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t6KGo5qC86L2sanNvbuWujOaIkC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLScpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSkuY2F0Y2goKGVycj86IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygn6KGo5qC86L2sanNvbumAieaLqeaWh+S7tuWkueWksei0pScpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuICAgIG9wZW5fYmluQ2hhbmdlKCkge1xyXG4gICAgICAgIGRpYWxvZy5zaG93T3BlbkRpYWxvZyh7XHJcbiAgICAgICAgICAgIHByb3BlcnRpZXM6IFsnb3BlbkRpcmVjdG9yeSddXHJcbiAgICAgICAgfSkudGhlbigocmVzdWx0PzogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmICghcmVzdWx0LmNhbmNlbGVkICYmIHJlc3VsdC5maWxlUGF0aHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcGF0aFRvID0gcmVzdWx0LmZpbGVQYXRoc1swXTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHRvQmluID0gcmVxdWlyZShcIi4veGxzeFRvQmluXCIpO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ+W8gOWni+ihqOagvOi9rGJpbicpO1xyXG4gICAgICAgICAgICAgICAgLy8g6K6+572u6L6T5Ye655uu5b2VXHJcbiAgICAgICAgICAgICAgICBjb25zdCBvdXRwdXREaXIgPSBwYXRoLmpvaW4oRWRpdG9yLlByb2plY3QucGF0aCwgJ2Fzc2V0cy9yZXNvdXJjZXMvYmluJyk7XHJcbiAgICAgICAgICAgICAgICAvLyDmiafooYzovazmjaJcclxuICAgICAgICAgICAgICAgIHRvQmluLnhsc3hUb0JpbmFyeShwYXRoVG8sIG91dHB1dERpcik7XHJcbiAgICAgICAgICAgICAgICAvL+i9rOaNouaIkOWKn++8jOmAmuefpeW8leaTjuWIt+aWsOi1hOa6kFxyXG4gICAgICAgICAgICAgICAgY29uc3QgZmxvYXRzID0gZnMucmVhZGRpclN5bmMob3V0cHV0RGlyKTtcclxuICAgICAgICAgICAgICAgIGZsb2F0cy5mb3JFYWNoKChmbG9hdDogc3RyaW5nKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZsb2F0LmVuZHNXaXRoKCcubWV0YScpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZ1bGxQYXRoID0gcGF0aC5qb2luKG91dHB1dERpciwgYCR7ZmxvYXR9YCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVDb250ZW50ID0gZnMucmVhZEZpbGVTeW5jKGZ1bGxQYXRoLCAndXRmOCcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIEVkaXRvci5NZXNzYWdlLnJlcXVlc3QoJ2Fzc2V0LWRiJywgJ3JlZnJlc2gtYXNzZXQnLCBmaWxlQ29udGVudFtcInV1aWRcIl0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLeihqOagvOi9rGJpbuWujOaIkC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLScpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSkuY2F0Y2goKGVycj86IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygn6KGo5qC86L2sYmlu6YCJ5oup5paH5Lu25aS55aSx6LSlJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG4gICAgb3Blbl9waWNfdHh0Q2hhbmdlKCkge1xyXG4gICAgICAgIGRpYWxvZy5zaG93T3BlbkRpYWxvZyh7XHJcbiAgICAgICAgICAgIHByb3BlcnRpZXM6IFsnb3BlbkRpcmVjdG9yeSddXHJcbiAgICAgICAgfSkudGhlbigocmVzdWx0PzogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmICghcmVzdWx0LmNhbmNlbGVkICYmIHJlc3VsdC5maWxlUGF0aHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcGF0aFRvID0gcmVzdWx0LmZpbGVQYXRoc1swXTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNvbnZlcnQgPSByZXF1aXJlKFwiLi9waWNUb1R4dFwiKTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCflvIDlp4vlm77niYfovax0eHQnKTtcclxuICAgICAgICAgICAgICAgIGNvbnZlcnQuY2hhbmdlVHh0RnVuYyhwYXRoVG8pXHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t5Zu+54mH6L2sdHh05a6M5oiQLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KS5jYXRjaCgoZXJyPzogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCflm77niYfovax0eHTpgInmi6nmlofku7blpLnlpLHotKUnKTtcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcbiAgICBvcGVuX3BpY19iaW5DaGFuZ2UoKSB7XHJcbiAgICAgICAgZGlhbG9nLnNob3dPcGVuRGlhbG9nKHtcclxuICAgICAgICAgICAgcHJvcGVydGllczogWydvcGVuRGlyZWN0b3J5J11cclxuICAgICAgICB9KS50aGVuKChyZXN1bHQ/OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgaWYgKCFyZXN1bHQuY2FuY2VsZWQgJiYgcmVzdWx0LmZpbGVQYXRocy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBwYXRoVG8gPSByZXN1bHQuZmlsZVBhdGhzWzBdO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY29udmVydCA9IHJlcXVpcmUoXCIuL3BpY1RvQmluXCIpO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ+W8gOWni+WbvueJh+i9rGJpbicpO1xyXG4gICAgICAgICAgICAgICAgY29udmVydC5pbWFnZXNUb0JpbmFyeVNpbXBsZShwYXRoVG8pXHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t5Zu+54mH6L2sYmlu5a6M5oiQLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KS5jYXRjaCgoZXJyPzogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCflm77niYfovaxiaW7pgInmi6nmlofku7blpLnlpLHotKUnKTtcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcbiAgICBvcGVuX3ZpZGVvRnJhbWUoKSB7XHJcbiAgICAgICAgZGlhbG9nLnNob3dPcGVuRGlhbG9nKHtcclxuICAgICAgICAgICAgcHJvcGVydGllczogWydvcGVuRGlyZWN0b3J5J11cclxuICAgICAgICB9KS50aGVuKChyZXN1bHQ/OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgaWYgKCFyZXN1bHQuY2FuY2VsZWQgJiYgcmVzdWx0LmZpbGVQYXRocy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBwYXRoVG8gPSByZXN1bHQuZmlsZVBhdGhzWzBdO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdmlkZW8gPSByZXF1aXJlKFwiLi92aWRlb0ZyYW1lXCIpO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ+W8gOWni+aPkOWPluinhumikemmluW4pycpO1xyXG4gICAgICAgICAgICAgICAgdmlkZW8udmlkZW9Ub0ZyYW1lKHBhdGhUbylcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pLmNhdGNoKChlcnI/OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ+inhumikemmluW4p+mAieaLqeaWh+S7tuWkueWksei0pScpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIEBlbiBNZXRob2QgVHJpZ2dlcmVkIG9uIEV4dGVuc2lvbiBTdGFydHVwXHJcbiAqIEB6aCDmianlsZXlkK/liqjml7bop6blj5HnmoTmlrnms5VcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBsb2FkKCkgeyB9XHJcblxyXG4vKipcclxuICogQGVuIE1ldGhvZCB0cmlnZ2VyZWQgd2hlbiB1bmluc3RhbGxpbmcgdGhlIGV4dGVuc2lvblxyXG4gKiBAemgg5Y246L295omp5bGV5pe26Kem5Y+R55qE5pa55rOVXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gdW5sb2FkKCkgeyB9XHJcbiJdfQ==